{% set ep = request.endpoint or '' %}
<nav class="tabbar" role="navigation" aria-label="Navigazione principale">
  <!-- Home -->
  <a href="{{ url_for('user.dashboard') }}"
     class="tabbar-item {{ 'active' if ep == 'user.dashboard' else '' }}"
     aria-label="Dashboard"
     aria-current="{{ 'page' if ep == 'user.dashboard' else 'false' }}">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
      <polyline points="9,22 9,12 15,12 15,22"></polyline>
    </svg>
  </a>

  <!-- Projects -->
  <a href="{{ url_for('user_projects.projects') }}" 
     class="tabbar-item {{ 'active' if ep == 'user_projects.projects' else '' }}"
     aria-label="Progetti"
     aria-current="{{ 'page' if ep == 'user_projects.projects' else 'false' }}">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
      <path d="M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"></path>
    </svg>
  </a>

  <!-- Referral -->
  <a href="{{ url_for('user.referral') }}" 
     class="tabbar-item {{ 'active' if ep == 'user.referral' else '' }}"
     aria-label="Referral"
     aria-current="{{ 'page' if ep == 'user.referral' else 'false' }}">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
    </svg>
  </a>

  <!-- Portfolio -->
  <a href="{{ url_for('user.portfolio') }}" 
     class="tabbar-item {{ 'active' if ep == 'user.portfolio' else '' }}"
     aria-label="Portfolio"
     aria-current="{{ 'page' if ep == 'user.portfolio' else 'false' }}">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
      <line x1="9" y1="3" x2="9" y2="21"></line>
      <line x1="15" y1="3" x2="15" y2="21"></line>
    </svg>
  </a>

  <!-- Profile -->
  <a href="{{ url_for('user.profile') }}" 
     class="tabbar-item {{ 'active' if ep == 'user.profile' else '' }}"
     aria-label="Profilo"
     aria-current="{{ 'page' if ep == 'user.profile' else 'false' }}">
    {% if current_user and current_user.avatar_url %}
      <img src="{{ current_user.avatar_url }}" alt="" class="h-6 w-6 rounded-full object-cover" loading="lazy">
    {% else %}
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
        <circle cx="12" cy="7" r="4"></circle>
      </svg>
    {% endif %}
  </a>
</nav>

